<html>
<head>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
    
	<script>
	var fiddly = {
		ready: function(callback) {callback()},
		save: function(data) {console.log(data)}
	};

	$(document).ready(function(){

		fiddly.ready(function(data) {
			$('canvas').on('mousedown', drawStart);
			$('canvas').on('mousemove', drawEnd);
			$('body').on('mouseup', stopDrawing);

			var canvas = document.getElementById('theCanvas');
			var context = canvas.getContext('2d');
			var lines = data || [];
			var currentLine;
			var drawStarted = false;

			function drawStart(e){
				context.beginPath();
				context.moveTo(e.clientX, e.clientY);
				currentLine = {startX : e.clientX, startY:e.clientY};
				drawStarted = true;
			}  

			function drawEnd(e){
				if(drawStarted)
				{
					context.lineTo(e.clientX, e.clientY);
					context.stroke();
					currentLine.endX = e.clientX;
					currentLine.endY = e.clientY
					lines.push(currentLine);
				}
			}

			function stopDrawing(){
				fiddly.save(lines);
				drawStarted = false;
			}

		});

	})
	</script>

</head>
<body>
	<canvas height="500" width="500" id="theCanvas" style="border: thin solid red;">

	</canvas>
</body>
</html>
