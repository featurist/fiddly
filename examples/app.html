<html>
<head>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>

	<style>
		.selected {
			background-color: lightgreen;
		}
	</style>
    
	<script>
	var fiddly = {
		ready: function(callback) {callback()},
		save: function(data) {console.log(data)}
	};

	$(document).ready(function(){

		fiddly.ready(function(data) {
			$('canvas').on('mousedown', drawStart);
			$('canvas').on('mousemove', drawEnd);
			$('body').on('mouseup', stopDrawing);

			var canvas = document.getElementById('theCanvas');
			var context = canvas.getContext('2d');
			var lines = data || [];
			var currentLine;
			var drawStarted = false;


			function drawStart(e){
				context.beginPath();
				context.moveTo(e.clientX, e.clientY);
				currentLine = {startX : e.clientX, startY:e.clientY};
				drawStarted = true;
			}  

			function drawEnd(e){
				if(drawStarted)
				{
					context.lineTo(e.clientX, e.clientY);
					context.stroke();
					currentLine.endX = e.clientX;
					currentLine.endY = e.clientY
					lines.push(currentLine);
				}
			}

			function stopDrawing(){
				fiddly.save(lines);
				drawStarted = false;
			}

			$('.lineWidth').on('click', function(){
				$('.lineWidth').removeClass('selected')
				$(this).addClass('selected')
				context.lineWidth = $(this).attr('data-width');
			})

			$('.lineColor').on('click', function(){
				$('.lineColor').removeClass('selected')
				$(this).addClass('selected')
				context.strokeStyle = $(this).attr('data-color');
			})

		});

	})
	</script>

</head>
<body>
	<canvas height="500" width="500" id="theCanvas" style="border: thin solid red;">

	</canvas>
	<div data-width='2' class='lineWidth selected'>
		Thin line
	</div>
	<div data-width='4' class='lineWidth'>
		Medium line
	</div>
	<div data-width='6'  class='lineWidth'>
		Thick line
	</div>

	<div data-color='red' class='lineColor selected'>
		Red
	</div>
	<div data-color='blue' class='lineColor'>
		Blue
	</div>
	<div data-color='green' class='lineColor'>
		Green
	</div>

</body>
</html>
